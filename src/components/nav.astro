---
import { Icon } from "astro-icon/components";
import ThemeSwitcher from "~/components/theme-switcher.astro";
import type { NavItem } from "~/types";

const navItems: Array<NavItem> = [
  { title: "Productos", url: "#products", icon: "mdi:package-variant" },
  { title: "Formas de pago y envío", url: "#shipping", icon: "mdi:truck-delivery" },
  { title: "¿Quiénes somos?", url: "#who_are_we", icon: "mdi:help-circle" },
  // { title: "Testimonios", url: "#testimonials" },
  { title: "Instagram", url: "https://instagram.com/nte_fitness", icon: "mdi:instagram" },
  { title: "WhatsApp", url: "https://wa.me/5352590878?text=Hola,%20estoy%20interesado%20en%20sus%20productos%20de%20suplementos%20deportivos.%20¿Podrían%20brindarme%20más%20información?", icon: "mdi:whatsapp" },
  { title: "Grupo WhatsApp", url: "https://chat.whatsapp.com/CVuXGKhFU4zEf6erJCYEbc", icon: "mdi:account-group" },
];
---

<header
  id="page-header"
  class="absolute bottom-0 z-20 flex w-full items-center justify-between border-b border-white px-4 sm:px-8 py-2 sm:py-4 text-white"
>
  <div class="flex items-center h-full">
    <a class="flex items-center gap-3 hover:!text-default" href="#">
      <h1 class="sr-only text-8xl sm:text-lg">NTE</h1>
      <span class="text-8xl sm:text-lg font-bold px-4 sm:px-3 py-4 sm:py-3" style="color: var(--color-red); background: var(--color-white); aspect-ratio: 1 / 1; display: inline-flex; align-items: center; justify-content: center;">NTE</span>
    </a>
  </div>
  <div>
    <div class="flex items-center gap-2 sm:gap-6">
  <nav class="block">
  <ul class="flex items-center gap-2 sm:gap-6 mt-3 sm:mt-6">
          {
            navItems.map(({ title, url, icon }) => (
              <li>
                <a
                  class="text-xs sm:text-sm flex items-center gap-1 sm:gap-2 transition-colors duration-200 nav-link px-1 sm:px-0"
                  href={url}
                  target={url.startsWith('http') ? '_blank' : undefined}
                  rel={url.startsWith('http') ? 'noopener' : undefined}
                  title={title}
                >
                  {icon ? (
                    <>
                      <Icon name={icon} class="w-7 h-7 sm:w-5 sm:h-5 icon-nav" />
                      <span class="hidden sm:inline text-xs sm:text-sm">{title}</span>
                    </>
                  ) : (
                    <span class="hidden sm:inline text-xs sm:text-sm">{title}</span>
                  )}
                </a>
              </li>
            ))
          }
        </ul>
      <div class="ml-2 sm:ml-0">
        <ThemeSwitcher />
      </div>
    </div>
</header>

<script>
  import invariant from "tiny-invariant";

  const header = document.querySelector("#page-header") as HTMLElement;
  const page = document.documentElement;

  invariant(header, "header should not be null");

  document.addEventListener("scroll", () => {
    const d = page.clientHeight - page.scrollTop - header.offsetHeight;
    header.classList.toggle("fixed-header", d < 0);
  });
</script>

<style>
  @media (max-width: 400px) {
    #page-header {
      padding: 0.25rem 0.5rem !important;
    }
    .nav-link {
      padding: 0.3rem !important;
      gap: 0.25rem !important;
    }
    .icon-nav {
      width: 1.8rem !important;
      height: 1.8rem !important;
    }
  }
  @media (max-width: 600px) {
    .section-title, .section-title * {
      font-size: 1em !important;
    }
    .section-content, .section-content * {
      font-size: 0.92em !important;
    }
  }
  @media (max-width: 600px) {
    html, body {
      font-size: 0.92em !important;
    }
    #page-header,
    #page-header * {
      font-size: 0.92em !important;
    }
    #page-header {
      padding: 0.5rem 1rem !important;
    }
    .nav-link {
      padding: 0.3rem !important;
      font-size: 0.75rem !important;
    }
    .icon-nav {
      width: 1.7rem !important;
      height: 1.7rem !important;
    }
  }
  @media (max-width: 600px) {
    footer .w-6,
    footer .h-6 {
      width: 1.1rem !important;
      height: 1.1rem !important;
    }
    footer a {
      font-size: 0.75rem !important;
      gap: 0.3rem !important;
      padding: 0.1rem 0 !important;
    }
    footer {
      padding-bottom: 0.7rem !important;
    }
  }
  .fixed-header {
    @apply fixed bottom-auto top-0;
    border-bottom: 1px solid white !important;
    @apply bg-default text-default;
  }
  .fixed-header .icon-nav {
    color: var(--color-red) !important;
  }
  .fixed-header .nav-link {
    color: var(--color-red) !important;
  }
  .nav-link {
    color: white;
    transition: color 0.2s;
  }
  .nav-link:hover, .nav-link:focus {
    color: var(--color-red) !important;
    background: white;
  }
  .nav-link:hover .icon-nav, .nav-link:focus .icon-nav {
    color: var(--color-red) !important;
  }
  .fixed-header .nav-link:hover, .fixed-header .nav-link:focus {
    color: white !important;
    background: var(--color-red);
  }
  .fixed-header .nav-link:hover .icon-nav, .fixed-header .nav-link:focus .icon-nav {
    color: white !important;
  }
  .icon-nav {
    color: white;
    transition: color 0.2s;
  }
  ::selection {
    background: var(--color-red);
    color: white;
  }
</style>
